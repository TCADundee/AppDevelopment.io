<!DOCTYPE html>
<html lang="en">
<head>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800&display=swap" rel="stylesheet">
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Hobby and Me — Home</title>
    <link rel="stylesheet" href="css/style.css" />
    <link rel="manifest" href="manifest.json">
</head>
<body class="dark-theme">

<header class="header">
    <!-- Hamburger symbol for the side menu -->
    <nav>
        <div class="ham-menu">
            <span></span>
            <span></span>
            <span></span>
        </div>
    </nav>
    <div class="off-screen-menu">
        <ul>
            <li><a href="settings.html">Search Settings</a></li>
            <li><a href="saved.html">Favourited Locations</a></li>
            <li><a href="accountSettings.html">Security and Privacy</a></li>
        </ul>
    </div>
    <h1 class="app-title">Hobby and Me</h1>
    <img id="profileAvatar" class="profile-pic" src="" alt="profile" />
</header>

<main class="container">
    <section class="section">
        <div class="section-header">
            <h2>Find something new</h2>
        </div>
        <div class="home-searchbox">
            <input id="searchInput" type="text" placeholder="Search for anything..." />
            <button id="searchBtn">Search</button>
        </div>
    </section>

    <section class="section">
        <div class="section-header">
            <h2>Random Hobbies</h2>
        </div>
        <div id="randomHobbyCarousel" class="carousel"></div>
    </section>
    
    <section class="section">
        <div class="section-header">
            <h2>All Hobbies</h2>
        </div>
        <div id="allHobbiesCarousel" class="carousel"></div>
    </section>

    <section class="section">
        <h2>Recently Viewed</h2>
        <div id="recentList" class="recent-list">
            <p class="muted">No recent searches yet — try tapping a category!</p>
        </div>
    </section>
</main>

<script src="js/core.js"></script>

<script>
  // When the page loads, render the recent hobbies from localStorage
  document.addEventListener("DOMContentLoaded", () => {
    renderRecents();  // Update the recent list on the page
  });

  // Function to render the recent hobbies list
  function renderRecents() {
    const recentsContainer = document.getElementById("recentList");
    const recents = JSON.parse(localStorage.getItem("recentHobbies") || "[]");

    if (recents.length === 0) {
      recentsContainer.innerHTML = "<p class='muted'>No recent searches yet — try tapping a category!</p>";
      return;
    }

    recentsContainer.innerHTML = ""; // Clear the existing recents

    recents.slice(0, 4).forEach(term => {
      const button = document.createElement("button");
      button.className = "recent-item";
      button.textContent = term;
      button.addEventListener("click", () => openCategoryAndSearch(term));
      recentsContainer.appendChild(button);
    });
  }

  // Function to open a category and search for it
  function openCategoryAndSearch(term) {
    // Save recent *for this user*
    let recents = JSON.parse(localStorage.getItem("recentHobbies") || "[]");

    // Prevent duplicates
    recents = recents.filter(item => item !== term);
    recents.unshift(term);

    // Save up to 30 recent categories
    localStorage.setItem("recentHobbies", JSON.stringify(recents.slice(0, 30)));

    // Navigate to results with term
    window.location.href = `results.html?query=${encodeURIComponent(term)}`;
  }
</script>

</body>
</html>

